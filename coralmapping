var imageCollection = ee.ImageCollection("COPERNICUS/S2_SR_HARMONIZED"),
    area1 = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[123.52881545228928, -5.245867467245998],
           [123.52544661380325, -5.249286302058543],
           [123.52310771150559, -5.252876065349244],
           [123.52116023836516, -5.255175650132967],
           [123.51957237062834, -5.257611537882582],
           [123.51671018946078, -5.263170495693117],
           [123.51675493879718, -5.267228424902891],
           [123.51769907637042, -5.270604411888026],
           [123.51988775892657, -5.276751648787054],
           [123.51978192414879, -5.278725897644537],
           [123.52197060670494, -5.283982075828886],
           [123.52145562257408, -5.28453760425154],
           [123.52188477601646, -5.285093132175992],
           [123.52265725221275, -5.2852640637448065],
           [123.52278599824547, -5.288212625880294],
           [123.52385538727349, -5.290947511537941],
           [123.52329748779839, -5.291802160826989],
           [123.52394121796196, -5.293084132546533],
           [123.52355497986382, -5.293511455862558],
           [123.52389830261772, -5.295733532345213],
           [123.52245069376426, -5.300325661496331],
           [123.52340791534685, -5.305115257284378],
           [123.5241374761989, -5.310035771108789],
           [123.52467247000448, -5.3136912480836616],
           [123.5273214832705, -5.320731461827381],
           [123.52745022930321, -5.322611597920164],
           [123.52762189068017, -5.323295282347102],
           [123.52817979015526, -5.323765314949684],
           [123.52792229808983, -5.325175410601357],
           [123.52865185894188, -5.327950287226286],
           [123.5306207087161, -5.329531292576364],
           [123.53289522196073, -5.335342520503971],
           [123.53290999275943, -5.336964845122771],
           [123.53329623085757, -5.339229493937334],
           [123.53329623085757, -5.341365947414572],
           [123.53059256417056, -5.3437204567325],
           [123.52879011971255, -5.344489575205236],
           [123.5271593366315, -5.343891372032116],
           [123.52497065407535, -5.3440195584755426],
           [123.52127993447085, -5.343464083693644],
           [123.52089369637271, -5.341669469417665],
           [123.51170981270572, -5.3377383912120795],
           [123.50230737160066, -5.329936950988306],
           [123.49711461494783, -5.326219447912832],
           [123.48651452492098, -5.324040211516296],
           [123.4785751862369, -5.321818237041397],
           [123.46990628670076, -5.322074619121299],
           [123.46123738716463, -5.324809354656065],
           [123.45651669929842, -5.329979680777925],
           [123.45528757362005, -5.3326716515297825],
           [123.45537340430853, -5.335491798702501],
           [123.45666086463568, -5.338853703277095],
           [123.4571329334223, -5.340733783882874],
           [123.45983660010931, -5.345092130375268],
           [123.45979171256671, -5.347187798435081],
           [123.4602208660091, -5.3489101235851475],
           [123.4625812099422, -5.351858380820804],
           [123.4639134875514, -5.3525420326429725],
           [123.46610217010755, -5.353952062112367],
           [123.46902041351575, -5.356387559899323],
           [123.46987872040052, -5.356430287844057],
           [123.47022204315442, -5.357242118226123],
           [123.47166046285385, -5.359763058325829],
           [123.47299083852523, -5.36121579874204],
           [123.47307666921371, -5.362070350313381],
           [123.47393497609848, -5.363480357790638],
           [123.47517952108139, -5.364633997848953],
           [123.47699334376712, -5.367613578025216],
           [123.4814565395679, -5.369450843157143],
           [123.48673512690921, -5.368297212209426],
           [123.48926713221927, -5.368339939320485],
           [123.49261452906985, -5.370219929242774],
           [123.49518944972415, -5.370305383192383],
           [123.50188424342532, -5.37393716497357],
           [123.50471665614505, -5.37389443825494],
           [123.5083644604053, -5.3752616917643055],
           [123.51145436519046, -5.373595351140629],
           [123.51780583613773, -5.377526198635879],
           [123.5178916668262, -5.379149802150791],
           [123.52063824885745, -5.382012460952308],
           [123.52583100551028, -5.384357002398913],
           [123.52935006373782, -5.385766958284469],
           [123.53166138949916, -5.388043564538908],
           [123.53294580481911, -5.389459579506089],
           [123.53468235501731, -5.389526701305645],
           [123.53550771517396, -5.3902652340860895],
           [123.53712202879255, -5.389064338016231],
           [123.5449458480297, -5.387652117896367],
           [123.54649740664341, -5.387565510006368],
           [123.54865720656728, -5.387351303862451],
           [123.5498122076686, -5.3866674010362],
           [123.5513553012635, -5.386987699866137],
           [123.55264182918314, -5.388215990073746],
           [123.553714243671, -5.3907100633037155],
           [123.55676099378923, -5.392042550147812],
           [123.55815563059427, -5.393969186516571],
           [123.56430317551963, -5.398638912212895],
           [123.56675469122366, -5.400578555490366],
           [123.5688387634172, -5.401334748177644],
           [123.57054598700623, -5.402759596997558],
           [123.57130304193389, -5.403899266936669],
           [123.57243258746875, -5.405451763774327],
           [123.57315829133272, -5.407627235149387],
           [123.57675051579812, -5.410990030208428],
           [123.57749521185295, -5.413237510305617],
           [123.57715944904211, -5.419189017787576],
           [123.57982397898895, -5.421673445933836],
           [123.58211110423834, -5.423428337576707],
           [123.58656988015807, -5.426570115070324],
           [123.59146002439081, -5.426966115174214],
           [123.59576117369988, -5.4295886415921055],
           [123.59844820469267, -5.431156226512002],
           [123.60148686900429, -5.431587562958671],
           [123.60651451756708, -5.434484085281574],
           [123.61149599326758, -5.435953685602716],
           [123.61778472252644, -5.437275944756422],
           [123.62729128791777, -5.440126578830222],
           [123.62960914528541, -5.440644015917118],
           [123.63356832003443, -5.44058233986423],
           [123.63662078443235, -5.43939799071912],
           [123.63902677407998, -5.438143615642468],
           [123.64159233822087, -5.435828893563769],
           [123.64418405126057, -5.433090790413534],
           [123.64681027716225, -5.4296710303544025],
           [123.64820920681065, -5.426081341858886],
           [123.64798598129968, -5.421701732395896],
           [123.64547110319417, -5.417931151618753],
           [123.64326952443342, -5.4158108817414625],
           [123.6382988382723, -5.413422337346755],
           [123.63667556103589, -5.413597208639775],
           [123.63342151314845, -5.411464976549452],
           [123.63074116839047, -5.408817056379122],
           [123.62917664145687, -5.406083680302901],
           [123.62997247291104, -5.400808173408112],
           [123.62925458443522, -5.399195815595265],
           [123.63076247675679, -5.397107915276674],
           [123.63572211466362, -5.396662109671978],
           [123.6401116845978, -5.395841042974853],
           [123.64325059356527, -5.393465134305328],
           [123.64494879104767, -5.391294474560829],
           [123.6457978824455, -5.388072865297463],
           [123.64583618352941, -5.385650260702659],
           [123.64420308828973, -5.3791408851896065],
           [123.64445943610957, -5.371186245297027],
           [123.65220537468318, -5.36949665703998],
           [123.65359983486498, -5.3610134150240105],
           [123.6530631008535, -5.356418320443971],
           [123.6468509750933, -5.331837367142952],
           [123.65455968502681, -5.315786300078353],
           [123.65498064990848, -5.294770161904617],
           [123.64952627285287, -5.2822962821568495],
           [123.63941761805181, -5.27588834499417],
           [123.63291812143203, -5.267651713963118],
           [123.6267620735801, -5.263517485795065],
           [123.61548018462285, -5.256958260674342],
           [123.59902435605845, -5.246328415212306],
           [123.59560313464225, -5.245457828229038],
           [123.58256894412335, -5.241168279240595],
           [123.57049099701058, -5.2397261015561565],
           [123.56548198873243, -5.241227207728524],
           [123.5611596022586, -5.242899222974966],
           [123.55567348811503, -5.244212604362175],
           [123.54778056893743, -5.244612817751559],
           [123.53902758205045, -5.2448128541272725],
           [123.53362111456299, -5.244570937794737]]],
         [[[123.52287746427682, -5.382500968873362],
           [123.52515197752145, -5.382928229882347],
           [123.52609611509469, -5.3831845863436305],
           [123.52560258863595, -5.382650510260653]]]]),
    area2 = 
    /* color: #ffc82d */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[123.52725286326215, -5.244907699711679],
          [123.51412076792523, -5.262001729411621],
          [123.5130611297613, -5.268859257646323],
          [123.5200134155279, -5.290225897945548],
          [123.52018507690485, -5.3113215874609],
          [123.52408920467252, -5.323362327127235],
          [123.5285524004733, -5.333617501140168],
          [123.53078399837369, -5.337121313001403],
          [123.53138481319303, -5.34036873051166],
          [123.52880989253873, -5.342334264331221],
          [123.52245842159147, -5.342248806470167],
          [123.51190124690885, -5.337804981274951],
          [123.51018463313932, -5.333788419256141],
          [123.49885498226041, -5.326097056934268],
          [123.47595047395353, -5.319174748541513],
          [123.46153091828947, -5.3218240362655225],
          [123.4551794473422, -5.328660855076815],
          [123.452261203934, -5.33729223014125],
          [123.45708661204901, -5.345523583856934],
          [123.45657162791815, -5.348685499866739],
          [123.4604340088996, -5.353812896503858],
          [123.4685020936164, -5.3581711498377675],
          [123.47195656591605, -5.364239318263276],
          [123.47590477758597, -5.36945203840178],
          [123.48225624853323, -5.37133202489411],
          [123.48869355016897, -5.370050216551071],
          [123.49907906347464, -5.374921073908651],
          [123.50817711645315, -5.3764592312976225],
          [123.51161034399222, -5.375604699894574],
          [123.51538689428519, -5.378424648972386],
          [123.51555855566214, -5.381073680142715],
          [123.52833148200143, -5.388134638208789],
          [123.5306489105903, -5.391381784239023],
          [123.53494044501413, -5.393005350741909],
          [123.54893084723581, -5.389672762176874],
          [123.55184909064401, -5.390698175991396],
          [123.57090350348581, -5.406182125838111],
          [123.57159014899362, -5.409258278306816],
          [123.57588168341745, -5.41224896710288],
          [123.57677354815634, -5.420931196584205],
          [123.5816658973995, -5.426143429630709],
          [123.5908497810665, -5.4286213606957],
          [123.60192193987997, -5.434687976511801],
          [123.63053906891447, -5.443148423741697],
          [123.64195455048186, -5.439816111704314],
          [123.64933598969084, -5.428537380235576],
          [123.64917712676112, -5.419920040483674],
          [123.64471393096034, -5.415220439654523],
          [123.63372760283534, -5.409409973568804],
          [123.63080935942713, -5.405052087383421],
          [123.63089519011561, -5.400694169836255],
          [123.63261180388514, -5.398387024329072],
          [123.64016490447108, -5.397874324135097],
          [123.64917712676112, -5.390823298187974],
          [123.6481471584994, -5.381252703921276],
          [123.64634471404139, -5.372878310396238],
          [123.65355449187342, -5.370229243570757],
          [123.65467029082362, -5.351444775039697],
          [123.64900546538416, -5.340198523557524],
          [123.64900546538416, -5.332165404570026],
          [123.6576743649203, -5.321025831359266],
          [123.65681605803553, -5.297195114658351],
          [123.65424113738123, -5.2842623431969615],
          [123.64806132781092, -5.279647166825353],
          [123.64196734892909, -5.2771686320009605],
          [123.63407092558924, -5.266741583983952],
          [123.58806598366486, -5.240371515801923],
          [123.57433307350861, -5.238491130267777],
          [123.566195480957, -5.238848712418121],
          [123.55804156555173, -5.24235306071639],
          [123.5449953009033, -5.24295136211935],
          [123.53349398864744, -5.242609475673571]]]),
    laut_dalam = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[123.65246989798547, -5.30240128109889],
         [123.6516115911007, -5.30496517789485],
         [123.65040996146203, -5.308340959094447],
         [123.64968040060998, -5.311887646016832],
         [123.6492512471676, -5.315477043324132],
         [123.64852285664463, -5.318534035580794],
         [123.6468062428751, -5.323063460775174],
         [123.6450037984171, -5.32767831251001],
         [123.64363050740147, -5.330498482619437],
         [123.64380216877842, -5.316653887029128],
         [123.64629125874424, -5.305971115874946],
         [123.64706373494053, -5.301356101496367],
         [123.64766454975987, -5.298108478106795],
         [123.65496015828037, -5.313662729773822],
         [123.65435934346104, -5.319474107702926],
         [123.65092611592198, -5.326310952645325],
         [123.64775038044834, -5.330071184950361],
         [123.64560149666138, -5.378083908936092],
         [123.45843034226642, -5.348198673592829],
         [123.4541388078426, -5.337430992312261],
         [123.53553276454163, -5.391609304483694],
         [123.53845100794983, -5.390925696492242],
         [123.54274254237366, -5.389900283061931],
         [123.64024620448303, -5.438776391574944],
         [123.63028984461975, -5.441852377889156],
         [123.58153801356507, -5.424763366200844],
         [123.57793312464905, -5.419978356123179],
         [123.56386525499526, -5.241043987836667],
         [123.52592809068862, -5.247539814576535],
         [123.51665837633315, -5.259847511263195],
         [123.51459843980972, -5.264291897504834],
         [123.51477010118667, -5.268223443472105],
         [123.51631505357925, -5.273180574668619],
         [123.51751668321792, -5.27728299813955]]),
    Sand = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[123.52862479745387, -5.373593675202312],
         [123.52965476571559, -5.374704569461073],
         [123.53162887155055, -5.375388195690055],
         [123.53446128427028, -5.374490936107141],
         [123.53600623666286, -5.373593675202312],
         [123.53660705148219, -5.371927330015507],
         [123.53304507791042, -5.370816430692488],
         [123.52592113076686, -5.35599886253026],
         [123.51682307778835, -5.354802478104253],
         [123.5063517337942, -5.350700570870042],
         [123.52787781972953, -5.357738568382498],
         [123.5290794493682, -5.357567656951618],
         [123.51961028072887, -5.262355595477483],
         [123.52101503712896, -5.258338510209209],
         [123.52092384202246, -5.258434663365244],
         [123.52082728249792, -5.258440005206816],
         [123.51963325384972, -5.262440144146436],
         [123.52020188216088, -5.260143162807221],
         [123.52039500120995, -5.259630347210904],
         [123.51967375659484, -5.268501075598481],
         [123.51996343516845, -5.269206186875583],
         [123.52004926585693, -5.269451907284133],
         [123.52095072796412, -5.2723544502108215],
         [123.52105801632472, -5.272739054075009],
         [123.52116530468531, -5.273123657700946],
         [123.52073609911139, -5.258640287926628],
         [123.6506957632076, -5.288347845323426],
         [123.65275569973103, -5.29633880365851],
         [123.6489325146523, -5.303071878129018],
         [123.64925437973409, -5.302687293108879],
         [123.64955478714376, -5.302559098048911],
         [123.520553123355, -5.271478654031767],
         [123.52119685351857, -5.273252105701307],
         [123.52128268420705, -5.273551241628187]]),
    Lamun = 
    /* color: #00ffff */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[123.51911545932302, -5.267547128659389],
         [123.51917983233938, -5.2681026717974895],
         [123.51930857837209, -5.268530012334971],
         [123.51930857837209, -5.268765049505313],
         [123.51928712069997, -5.269042820591981],
         [123.5194373244048, -5.269256490574161],
         [123.51956607043752, -5.269299224561769],
         [123.51967335879812, -5.269619729375178],
         [123.51982356250295, -5.270068435836145],
         [123.51995230853566, -5.2704316741623956],
         [123.52003813922414, -5.270773545334209],
         [123.5201025122405, -5.271136783248081],
         [123.52014542758474, -5.271297035201365],
         [123.52022052943715, -5.271606855527116],
         [123.52026344478139, -5.271809841173974],
         [123.52028490245351, -5.271927359149724],
         [123.52040291965017, -5.27211966124388],
         [123.5204458349944, -5.272279912943509],
         [123.5204458349944, -5.272418797716405],
         [123.52051020801076, -5.272536315576893],
         [123.520553123355, -5.272675200292424]]),
    Laut = 
    /* color: #bf04c2 */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[123.51752279307314, -5.2621289623397765],
         [123.51770518328615, -5.262203747673599],
         [123.51778028513857, -5.262620408654541],
         [123.51772664095827, -5.262834080844205],
         [123.51745842005678, -5.263026385752133],
         [123.51724384333559, -5.263037069356386],
         [123.51670740153261, -5.263122538183815],
         [123.51662311278015, -5.263526850633004],
         [123.51661238394409, -5.263879409192772],
         [123.5169020625177, -5.264103764535837],
         [123.51720246992737, -5.264349486961558],
         [123.51727757177979, -5.264541791400916],
         [123.51707372389465, -5.264830247948427],
         [123.5168484183374, -5.265065286517832],
         [123.51669821463257, -5.265225540036941],
         [123.51665529928833, -5.2656208318741395],
         [123.5165587397638, -5.265941338584635],
         [123.51651582441956, -5.266176376733989],
         [123.51658019743591, -5.266400731248189],
         [123.51711663923889, -5.2663045793234495],
         [123.51741704664856, -5.266251161581059],
         [123.5175672503534, -5.266541400672363],
         [123.5175672503534, -5.266904641060503],
         [123.51754579268128, -5.2671610459125775],
         [123.51707372389465, -5.267652488250008],
         [123.5170093508783, -5.268143930198802],
         [123.5170093508783, -5.268699472803332],
         [123.5175672503534, -5.268891775896856],
         [123.51799640379578, -5.269019977926157],
         [123.51814660750061, -5.269447317832706],
         [123.51763162336975, -5.269981492302517],
         [123.51741704664856, -5.270430198502157],
         [123.51754579268128, -5.270729335788508],
         [123.51780168934178, -5.270870267341443],
         [123.51806454582524, -5.270918342952411],
         [123.51814257420224, -5.271173773018559],
         [123.51833569325132, -5.271344708423747],
         [123.51861464298887, -5.271355391885002],
         [123.51870047367734, -5.271590427986258],
         [123.51852881230039, -5.271804097092028],
         [123.51832496441526, -5.271878881261677],
         [123.51828204907102, -5.272124600612821],
         [123.51824986256284, -5.272316902645898],
         [123.51816403187436, -5.272541254942526],
         [123.5182069472186, -5.272776290594903],
         [123.51837860859555, -5.27303269302328],
         [123.51868974484128, -5.272968592426115],
         [123.51885067738218, -5.273000642725532],
         [123.5188635999569, -5.273122529385115],
         [123.51878849810448, -5.273389615096764],
         [123.51871339625207, -5.273635333849975],
         [123.51884214228478, -5.2738703690881295],
         [123.51903526133385, -5.27408403740922],
         [123.51911036318627, -5.274319072477456],
         [123.51903526133385, -5.274543424050471],
         [123.51914919459264, -5.274673830499563],
         [123.5193208559696, -5.274802031335074],
         [123.51951397501867, -5.2749088653444485],
         [123.51952470385473, -5.275101166514958],
         [123.51943887316625, -5.275261417444867],
         [123.51946033083837, -5.275421668333391],
         [123.51953543269079, -5.275592602568873]]),
    Land = 
    /* color: #ff0000 */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[123.51915993930923, -5.263592885796217],
         [123.51909556629288, -5.263763823286564],
         [123.51902046444046, -5.264062963781586],
         [123.51894536258804, -5.264298002641007],
         [123.51910629512894, -5.264559750357188],
         [123.51931310718058, -5.263114513984736],
         [123.5196778876066, -5.262665802503965],
         [123.51993537967203, -5.262569650001687],
         [123.52008558337687, -5.262313243256292],
         [123.5198924643278, -5.262024785541389],
         [123.51992465083597, -5.261576073274587],
         [123.51916918485213, -5.265048243090865],
         [123.51906189649154, -5.265251230880335],
         [123.5190726253276, -5.265432851477878],
         [123.51927647321273, -5.266398279368293],
         [123.5193086597209, -5.266708102136963],
         [123.51931938855697, -5.266985874143091],
         [123.51942667691756, -5.26708202596244],
         [123.51954469411422, -5.267210228365087],
         [123.51958760945845, -5.267488000146809],
         [123.51949104993392, -5.267744404758191],
         [123.5194695922618, -5.267958075186857],
         [123.51988207723042, -5.2684542858599315],
         [123.51990353490254, -5.2686893230589105],
         [123.52045070554158, -5.2685397539425765],
         [123.5212124529018, -5.2682619826309915],
         [123.52217422598942, -5.267901035538346],
         [123.52275358313663, -5.267740782709022],
         [123.52232576833161, -5.266287722340357],
         [123.52103830800446, -5.266757798288238],
         [123.52189661488923, -5.264407414994297],
         [123.52065206990632, -5.264450149315317],
         [123.51979376302155, -5.262997180753374],
         [123.521591238275, -5.273721545287268],
         [123.52167170454544, -5.273988630741163],
         [123.52183800150436, -5.274389258706538],
         [123.52190773893875, -5.274634977064013],
         [123.52213840891403, -5.274982187620675],
         [123.522492460504, -5.274902062124843],
         [123.52233689238113, -5.274528143007504],
         [123.52215450216812, -5.274009997572518],
         [123.52253514026029, -5.275356106464448],
         [123.52286773417813, -5.276146676992315],
         [123.52302866671903, -5.2767876793835224],
         [123.52317887042386, -5.277247064023122],
         [123.5227711746536, -5.276766312647814],
         [123.52268534396512, -5.276178727127614],
         [123.52331355217702, -5.277523069234777],
         [123.52342084053761, -5.278260220291902],
         [123.52359250191456, -5.27868755383687],
         [123.52208260475965, -5.268673131165666],
         [123.52362755715222, -5.268758599218209],
         [123.52474335610242, -5.269442343215268],
         [123.52345589577527, -5.270126086459783],
         [123.52311257302136, -5.270809828951651],
         [123.52508667885633, -5.270809828951651],
         [123.52328423439832, -5.271493570690785],
         [123.52448586403699, -5.273031986851136],
         [123.52603081642957, -5.271920908895457]]),
    Coral = 
    /* color: #ffc82d */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[123.51825611023693, -5.2665368869066755],
         [123.51843313603192, -5.266472785639203],
         [123.51859406857281, -5.266414026138214],
         [123.51886765389233, -5.2664567603213],
         [123.5190607729414, -5.266510178046033],
         [123.51864771275311, -5.266868076683286],
         [123.51878182320385, -5.267119139783443],
         [123.51898567108898, -5.2671725574512305],
         [123.51786450772076, -5.266056127239533],
         [123.51733879475384, -5.265831772600949],
         [123.51694182781964, -5.26586916504634],
         [123.5168989124754, -5.265591392541196],
         [123.51694182781964, -5.265383063080899],
         [123.51721369282362, -5.265299408927188],
         [123.51744972721693, -5.2650216361674715],
         [123.51763211742994, -5.264604976795239],
         [123.51754628674146, -5.264060114117986],
         [123.51800583621942, -5.26703090975916],
         [123.51779125949822, -5.267650554511324],
         [123.51749085208856, -5.267928326096219],
         [123.51757668277703, -5.268248831616817],
         [123.51796292087518, -5.268355666753609],
         [123.51826332828485, -5.26852660293428],
         [123.51860665103875, -5.269701787903243],
         [123.51839207431756, -5.270000925540398],
         [123.51809166690789, -5.270257329114717],
         [123.51826332828485, -5.270641934277741],
         [123.51839207431756, -5.270898337587449],
         [123.51873539707147, -5.270855603709849],
         [123.51907254397878, -5.27089489099419],
         [123.51924420535573, -5.271450431138498],
         [123.5192012900115, -5.271856402468102],
         [123.51892234027395, -5.27207007148235],
         [123.51866484820852, -5.272176905961899],
         [123.5186433905364, -5.272433308637825],
         [123.51894379794606, -5.272433308637825],
         [123.51922274768361, -5.2725401430548695],
         [123.51935149371633, -5.272967480539236],
         [123.51930857837209, -5.2733948177294385],
         [123.51913691699514, -5.273651219902342],
         [123.51937295138845, -5.273779420949093],
         [123.51849318683156, -5.27014704770753],
         [123.51720572650441, -5.263758292656326],
         [123.51694823443898, -5.263672823916272],
         [123.51780654132375, -5.261728406907207],
         [123.51802111804494, -5.261322428962557],
         [123.51795674502858, -5.261685672399194],
         [123.51814986407766, -5.261322428962557],
         [123.5186433905364, -5.270175270660046],
         [123.51704414010692, -5.263234985273671],
         [123.51720507264781, -5.263352504870946],
         [123.5173820984428, -5.263387226565896],
         [123.51762349725414, -5.263315112274223],
         [123.51781125188518, -5.2631468455611365],
         [123.51787294269252, -5.263064047637986],
         [123.51800705314326, -5.262796957488192]]),
    imageVisParam = {"opacity":1,"bands":["B2","B3","B4"],"min":0.13079199820756912,"max":0.45680800944566724,"gamma":1},
    imageVisParam2 = {"opacity":1,"bands":["X2","X3","X4"],"min":-11.046893146000382,"max":-1.279276807692818,"gamma":1},
    imageVisParam3 = {"opacity":1,"bands":["Y23","Y24","Y34"],"gamma":1},
    Chairunnisa = 
    /* color: #98ff00 */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[123.34, -5],
          [123.34, -6.25],
          [124.64, -6.25],
          [124.64, -5]]], null, false),
    LaOde = /* color: #98ff00 */ee.Geometry.Polygon(
        [[[123.515, -5.256278],
          [123.515, -5.275917],
          [123.5208, -5.275917],
          [123.5208, -5.256278]]]),
    geometry = 
    /* color: #0b4a8b */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[123.62770294840311, -5.272125704765661],
          [123.62770294840311, -5.346307114743371],
          [123.65791535074686, -5.346307114743371],
          [123.65791535074686, -5.272125704765661]]], null, false);
// step 1 import dan memilih citra Sentinel 2A pada rentang waktu dan dan area beserta cloud mask
function maskS2clouds(image) {
  var qa = image.select('QA60');

  var cloudBitMask = 1 << 10;
  var cirrusBitMask = 1 << 11;

  var mask = qa.bitwiseAnd(cloudBitMask).eq(0).and(
             qa.bitwiseAnd(cirrusBitMask).eq(0));

  return image.updateMask(mask).divide(10000)
      .select("B.*")
      .copyProperties(image, ["system:time_start"]);
}

var sr2ACol = ee.ImageCollection('COPERNICUS/S2_SR')
    .filterDate('2023-01-01', '2023-12-31')
    .filterBounds(area2)
    .filter(ee.Filter.lt('CLOUDY_PIXEL_PERCENTAGE', 20))
    .map(maskS2clouds)
    .median();
Map.centerObject(area1, 13.5);

// step 2 menampilkan citra pada peta
Map.addLayer(sr2ACol.clip(area1), imageVisParam, 'RGB');

// step 4 koreksi permukaan (Xij)
// step 4.1 rerata nilai laut dalam
var image = sr2ACol.select("B1", "B2", "B3", "B4", "B8").clip(area1);

var extent = ee.Feature(laut_dalam);
var deepAve = image.reduceRegion({
  reducer: ee.Reducer.mean(),
  geometry: extent.geometry(),
  scale: 10,
  maxPixels: 1e9
});

print(deepAve);

// step 4.2 implementasi algoritma Xi = ln(laut dangkal - rerata laut dalam)
var X1cor = image.select(['B1']).subtract(0.145818).log().rename('X1');
var X2cor = image.select(['B2']).subtract(0.140087).log().rename('X2');
var X3cor = image.select(['B3']).subtract(0.128643).log().rename('X3');
var X4cor = image.select(['B4']).subtract(0.122570).log().rename('X4');

var Xij = X1cor.addBands(X2cor).addBands(X3cor).addBands(X4cor);

Map.addLayer(Xij,imageVisParam2, 'Image Koreksi Permukaan');

// step 5 implementasi algoritma Yij
// step 5.1 calculate ki/kj
var imgsand = Xij.clip(Sand);
var k23 = imgsand.select(['X2','X3'])
    .reduceRegion(ee.Reducer.linearRegression(1,1), imgsand.get('system:footprint'), 10);
print(k23);
var k24 = imgsand.select(['X2','X4'])
    .reduceRegion(ee.Reducer.linearRegression(1,1), imgsand.get('system:footprint'), 10);
print(k24);
var k34 = imgsand.select(['X3','X4'])
    .reduceRegion(ee.Reducer.linearRegression(1,1), imgsand.get('system:footprint'), 10);
print(k34);

// step 5.2 calculate depth invariance index
var Y23 = Xij.select(['X2']).subtract(Xij.select(['X3']).multiply(0.828411)).rename('Y23');
var Y24 = Xij.select(['X2']).subtract(Xij.select(['X4']).multiply(0.896653)).rename('Y24');
var Y34 = Xij.select(['X3']).subtract(Xij.select(['X4']).multiply(1.087374)).rename('Y34');

var Yij = Y23.addBands(Y24).addBands(Y34);

Map.addLayer(Yij, imageVisParam3, 'Indeks Kedalaman Yij');

// step 6 sampling data collection
// step 6.1 class "vegetasi", "pasir", "terumbu karang", "laut dalam"
var points = ee.FeatureCollection([
  ee.Feature(Sand, {class: 0}),
  ee.Feature(Coral, {class: 1}),
  ee.Feature(Lamun, {class: 2}),
  ee.Feature(Land, {class: 3}),
  ee.Feature(Laut, {class: 4})
  ]);
  
  // step 6.2 training and testingg data
var bands = ['B2', 'B3', 'B4', 'B8'];
var training = image.select(bands).sampleRegions({
  collection: points,
  properties: ['class'],
  scale: 10
});

var withRandom = training.randomColumn('random');
var split = 0.7; //70% training 30% testing
var trainingPoints = withRandom.filter(ee.Filter.lt('random', split));
var testingPoints = withRandom.filter(ee.Filter.lt('random', split));

print(testingPoints);

//Step 7 Klasifikasi
//SVM
var classifier = ee.Classifier.libsvm({
  kernelType: 'RBF',
  gamma: 0.5,
  cost:10
});
// Train the Classifier
var trained = classifier.train(trainingPoints, 'class', bands);

//classify image
var classified = image.classify(trained);
Map.addLayer(classified,
            {min:0, max: 4, palette: [ 'white', 'pink', 'yellow', 'green', 'blue']}, 
            'Terumbu Karang Supervised');
var validation = testingPoints.classify(trained);
print (validation);

//uji akurasi
var testAccuracy = validation.errorMatrix('class','classification');
print('Validation error matrix: ', testAccuracy);
print('Validation overall accuracy: ',testAccuracy.accuracy());

var OA = testAccuracy.accuracy();
var CA = testAccuracy.consumersAccuracy();
var Kappa = testAccuracy.kappa();
var Order = testAccuracy.order();
var PA = testAccuracy.producersAccuracy();

print(OA, 'Overall Accuracy');
print(CA, 'Consumers Accuracy');
print(Kappa, 'Kappa');
print(Order, 'Order');
print(PA, 'Producers Accuracy');

//Mengukur luasan
var class_areas = ee.Image.pixelArea().divide(1000*1000).addBands(classified).reduceRegion({
  reducer:ee.Reducer.sum().group({
    groupField:1,
    groupName:'code',
  }),
  geometry: area1,
  maxPixels: 500000000,
  scale: 10,
}).get('groups');

print(class_areas);

//klasifikasi unsupervised
var training = Yij.sample({
region: area1,
scale: 30,
numPixels: 5000
});
var clusterer = ee.Clusterer.wekaKMeans(30).train(training);
var result2010 = Yij.cluster(clusterer);
Map.addLayer(result2010.randomVisualizer(), {}, 'Terumbu Karang Unsupervised');

// Anggap Anda memiliki gambar klasifikasi (`classifiedImage`)
var clusterToExtract = [18,9,5]; // Ubah ini ke ID cluster yang diinginkan
var clusterBand = result2010.select('cluster');
var mergedClusterMask = clusterBand.eq(clusterToExtract[0]);
for (var i = 1; i < clusterToExtract.length; i++) {
  mergedClusterMask = mergedClusterMask.or(clusterBand.eq(clusterToExtract[i]));
}
Map.addLayer(mergedClusterMask,{min:0,max: 3, palette:['white', 'yellow', 'green']},'Karang_Saja');

var luasankarang = ee.Image.pixelArea().divide(1000*1000).addBands(mergedClusterMask).reduceRegion({
  reducer:ee.Reducer.sum().group({
    groupField:1,
    groupName:'code',
  }),
  geometry: geometry,
  maxPixels: 500000000,
  scale: 10,
}).get('groups');

print(luasankarang);

// Export the image, specifying scale and region.
Export.image.toDrive({
  image: classified,
  description: 'Pemetaan Terumbu Karang Supervised',
  scale: 30,
  region: area1,
  fileFormat: 'GeoTIFF'
});

// Export the image, specifying scale and region.
Export.image.toDrive({
  image: result2010,
  description: 'Pemetaan Terumbu Karang Unsupervised',
  scale: 30,
  region: area1,
  fileFormat: 'GeoTIFF'
});
